Модель реактивного маховика должна быть учтена до моделирования динамики ориентации, так как маховики влияют на тензор инерции всего аппарата.
На борту установлены три реактивных маховика, каждый имеет:
- свою угловую скорость $\omega_R$
- своё угловое ускорение $\alpha_R$
Тензор инерции маховика изначально записывается относительно собственного центра масс и расчитываетя по формуле для цилиндра конечного радиуса $r$ и высоты $h$.

$$
I^R_{R_i} = 
\begin{bmatrix}
m_Rr^2/2 & 0 & 0 \\
0 & (m_R/12)(3r^2_{RW}+h^2_{RW}) & 0 \\
0 & 0 & (m_R/12)(3r^2_{RW}+h^2_{RW})
\end{bmatrix}
$$
нижний индекс $_R$ указывает, что тензор инерции относиться к центру масс маховика
верхний индекс $^R$ указывает, что тензор выражен в локальной системе координат маховика.

Перед тем как моделировать поведение спутника, необходимо:
1. Вычислить тензор инерции маховиков $I_R^R$ в их локальных осях
2. Преобразовать их в систему координат спутника:
		Используют ось вращения маховика, эта ось обозначается как $\hat{n}_{R_i}$, указывающий направление оси вращеия $i-$го реактивного маховика. Из этого вектора можно извлечь углы Эйлера $\theta_{R_i}$(тангаж) и $\psi_{R_i}$(рыскание)  
		$I_{R_i}^B=R_i^TI_{R_i}^RR_i$ 
3. Учесть смещение от центра масс спутника (Теорема Гюйгенса-Штейнера)
			$I^B_{RBi}=I^B_{Ri}+m_{R_i} \cdot S(\vec{r_{Ri}}) \cdot S^T(\vec{r_{Ri}})$
			$I^B_{RB}$ - тензор инерции маховика, приведенный к центру масс спутника
			$\vec{r_{R_i}}$ -вектор от центра масс спутника до центра масс маховика в системе спутника
			$S$ - кососимметрическая матрица
4. Сложить со срутктурой инерции спутника для получения полного тензора инерции $I_{S}$ 
		$I_S=I_B+\sum{I^B_{RB_i}}$



Полный момент импульса всей системы задаётся следующим выражением:
$$
	\vec{H_S} = I_B\vec{\omega_{B/I}}+\sum{I^B_{R_i}\omega_{R_i}\hat{n}_{R_i}}
$$
где
	$\vec{H_S}$ - полный вектор углового момента всей системы
	$I_B$ - тензор инерции спутника
	$\vec{\omega_{B/I}}$ - угловая скорость спутника относителььно инерциальной СК
	$I^R_{R_i}$ - тензор инерции $i$-го маховика в системе координат спутника
	$\omega_{R_i}$ - угловая скорость $i-$го маховика
	$\hat{n}_{R_i}$ - единичный вектор напряления оси вращения маховика
Суммарный момент сил, создаваемый маховиками на спутник, задается выражением:
$$
\vec{M_R} = \sum{I^B_{R_i}\alpha_{R_i}\hat{n}_{R_i}}
$$
где:
$\alpha_{R_i}$ - угловое ускорение маховика

### Ограничения управления маховиками

Обычно полагается, что угловое ускорение $\alpha_{R_i}$ можно задавать напрямую
Онднако по мере увеличения скорости маховика $\omega_{R_i}$, его максимально допустимое ускорение уменьшается.
**Когда маховик достигает совего предельного значениия скорости - дальнейшее ускорение становиться невозможным**. Этот эффект называется насыщением маховика.
Для борьбы с ним используют метод, называемы **сброс импульса (momentum dumping)** - сброс накопленного момента за счет внешних органов (например, магнитометров или микродвигателей)
